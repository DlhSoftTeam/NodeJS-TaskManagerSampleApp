var DlhSoft;"undefined"===typeof DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)});DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.HTML.Core",company:"DlhSoft",product:"Project Data Script Framework",version:"5.0.6.1",copyright:"Copyright \u00a9 2013-2020 DlhSoft",title:"Project Data JavaScript Core",description:"Project Data JavaScript framework components"});"undefined"==typeof document&&(document=null);"undefined"==typeof alert&&"undefined"!=typeof console&&(alert=console.log);
DlhSoft.buildReleaseDate=function(E,w,C){E=new Date(E,w-1,C);return E>DlhSoft.buildReleaseDate?E:DlhSoft.buildReleaseDate}(2020,4,13);var _0x3046="Licensing{Components{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n{body{span".split("{");
if(void 0==DlhSoft[_0x3046[0]]||void 0==DlhSoft[_0x3046[0]][_0x3046[1]])DlhSoft[_0x3046[0]]=function(){var E=_0x3046[2],w=_0x3046[3],C=[],J=[],L=_0x3046[4],O=function(z,p){if(typeof z!==w||typeof p!==w)return false;if(p==L)return true;var A=p[_0x3046[12]](_0x3046[11]);if(A>=0){var k=p[_0x3046[13]](0,A),h,r=k[_0x3046[12]](_0x3046[11]);if(r>=0)try{h=new Date(parseInt(k[_0x3046[13]](r+1)))}catch(q){}typeof h===E&&(h=new Date(2013,11,31));if(DlhSoft[_0x3046[14]]>h)return false;k=k+_0x3046[11]+z;for(i=
h=0;i<k[_0x3046[6]];i++){r=k[_0x3046[15]](i);h=(h<<5)-h+r;h=h&h}h<0&&(h=Math[_0x3046[16]](2,32)-h);k=h.toString(16)[_0x3046[17]]();A=p[_0x3046[13]](A+1);if(k==A)return true}return false},R=function(z,p,A,k,h){var r=_0x3046[18],q=_0x3046[19],x=typeof ComponentSource===E||!ComponentSource?q+_0x3046[20]+k+_0x3046[21]+h:_0x3046[22],w=k+_0x3046[23]+h+_0x3046[24],C=_0x3046[25],l=_0x3046[26],G=_0x3046[27];setTimeout(function(){var h=z[_0x3046[28]];if(h!=void 0){var k=h[_0x3046[30]](_0x3046[29]);k[_0x3046[33]](_0x3046[31],
_0x3046[32]);var D=h[_0x3046[30]](_0x3046[29]);D[_0x3046[33]](_0x3046[31],_0x3046[34]);var t=h[_0x3046[30]](_0x3046[29]);t[_0x3046[33]](_0x3046[31],_0x3046[35]);D[_0x3046[36]](t);t[_0x3046[36]](h[_0x3046[37]](r));D[_0x3046[36]](h[_0x3046[37]](C+_0x3046[11]));t=h[_0x3046[30]](_0x3046[29]);t[_0x3046[33]](_0x3046[31],_0x3046[38]);t[_0x3046[36]](h[_0x3046[37]](p));D[_0x3046[36]](t);D[_0x3046[36]](h[_0x3046[37]](l+_0x3046[11]));t=h[_0x3046[30]](_0x3046[29]);t[_0x3046[33]](_0x3046[31],_0x3046[38]);t[_0x3046[36]](h[_0x3046[37]](w));
D[_0x3046[36]](t);D[_0x3046[36]](h[_0x3046[37]](G+_0x3046[11]));t=h[_0x3046[30]](_0x3046[29]);t[_0x3046[33]](_0x3046[31],_0x3046[39]);var B=h[_0x3046[30]](_0x3046[40]);B[_0x3046[33]](_0x3046[31],_0x3046[41]);B[_0x3046[33]](_0x3046[42],x);B[_0x3046[33]](_0x3046[43],_0x3046[44]);B[_0x3046[36]](h[_0x3046[37]](_0x3046[45]));t[_0x3046[36]](B);B=h[_0x3046[30]](_0x3046[40]);B[_0x3046[33]](_0x3046[31],_0x3046[46]);B[_0x3046[33]](_0x3046[42],_0x3046[47]);B[_0x3046[36]](h[_0x3046[37]](_0x3046[48]));B[_0x3046[51]](_0x3046[49],
function(){z[_0x3046[50]](k);J[_0x3046[8]](A)},false);t[_0x3046[36]](B);D[_0x3046[36]](t);k[_0x3046[36]](D);z[_0x3046[36]](k)}else alert(r+_0x3046[52]+C+_0x3046[53]+p+_0x3046[52]+l+_0x3046[54]+w+_0x3046[52]+G+_0x3046[53]+q)},0);setTimeout(function(){alert(r+_0x3046[52]+C+_0x3046[53]+p+_0x3046[52]+l+_0x3046[54]+w+_0x3046[52]+G+_0x3046[5])},6E5)};return{setLicense:function(z,p){C[_0x3046[8]]({type:z,content:p})},validate:function(z,p,A,k,h,r,q){for(var p=p+_0x3046[5]+A,x=0;x<J[_0x3046[6]];x++)if(J[x]==
p)return;a:{if(typeof r!==w&&typeof q!==E){q[_0x3046[7]]!==E&&(r=q[_0x3046[7]]);typeof q===w&&(r=q)}if(typeof r!==w)for(q=0;q<C[_0x3046[6]];q++){x=C[q];if(x[_0x3046[9]]==p&&typeof x[_0x3046[10]]===w){r=x[_0x3046[10]];break a}}}O(p,r)?z[_0x3046[7]]=r:R(z,A,p,k,h)},Components:function(){return{createInstance:function(){if(document){var z=document[_0x3046[55]];if(z!=null){var p=document[_0x3046[30]](_0x3046[56]);z[_0x3046[36]](p);return p}}return{}}}}()}}();void 0==DlhSoft.Data&&(DlhSoft.Data={});
void 0==DlhSoft.Data.TaskManager&&(DlhSoft.Data.TaskManager=function(){var E=new Date(2592E5),w=new Date(3155762592E5),C=function(a,e,d){var c=DlhSoft.Licensing.Components.createInstance(),f=["DlhSoft.Data","TaskManager","DlhSoft.ProjectData.HTML.Core","5","validate","Licensing"];DlhSoft[f[5]][f[4]](c,f[0],f[1],f[2],f[3],d,e);L(a,e);typeof e!=="object"&&(e={});d=e;if(typeof d.areTaskDependencyConstraintsEnabled==="undefined")d.areTaskDependencyConstraintsEnabled=true;if(typeof d.schedule!=="undefined"&&
d.schedule!=null){if(d.schedule!=d.previousSchedule||d.schedule.workingWeekStart!=d.previousSchedule.workingWeekStart)d.workingWeekStart=d.schedule.workingWeekStart;if(d.schedule!=d.previousSchedule||d.schedule.workingWeekFinish!=d.previousSchedule.workingWeekFinish)d.workingWeekFinish=d.schedule.workingWeekFinish;if(d.schedule!=d.previousSchedule||d.schedule.workingDayStart!=d.previousSchedule.workingDayStart)d.workingDayStart=d.schedule.workingDayStart;if(d.schedule!=d.previousSchedule||d.schedule.workingDayFinish!=
d.previousSchedule.workingDayFinish)d.workingDayFinish=d.schedule.workingDayFinish;if(d.schedule!=d.previousSchedule||d.schedule.nonworkingDays!=d.previousSchedule.nonworkingDays)d.nonworkingDays=d.schedule.nonworkingDays}if(typeof d.nonworkingDays!=="undefined")for(f=0;f<d.nonworkingDays.length;f++)d.nonworkingDays[f]=k(new Date(d.nonworkingDays[f].valueOf()-d.nonworkingDays[f].getTimezoneOffset()*6E4));if(typeof d.workingDayStart==="undefined")d.workingDayStart=288E5;if(typeof d.workingDayFinish===
"undefined")d.workingDayFinish=576E5;if(typeof d.workingWeekStart==="undefined")d.workingWeekStart=1;if(typeof d.workingWeekFinish==="undefined")d.workingWeekFinish=5;ua(c,a,e);O(a);R(a,e,c);return c},J=function(a){for(var e=0;e<a.items.length;e++)delete a.items[e].successors;C(a,a.items,a.settings,a.license)},L=function(a,e){for(var d=0;d<a.length;d++){var c=a[d];if(typeof c==="string"){c={tag:c};a[d]=c}if(typeof c.indentation==="string")c.indentation=parseInt(c.indentation);if(typeof c.start===
"string"){try{c.start=new Date(c.start)}catch(f){c.start=new Date(parseInt(c.start))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)c.start=new Date(c.start.valueOf()+c.start.getTimezoneOffset()*6E4)}if(typeof c.finish==="string"){try{c.finish=new Date(c.finish)}catch(b){c.finish=new Date(parseInt(c.finish))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)c.finish=new Date(c.finish.valueOf()+c.finish.getTimezoneOffset()*6E4)}if(typeof c.completedFinish===
"string"){try{c.completedFinish=new Date(c.completedFinish)}catch(j){c.completedFinish=new Date(parseInt(c.completedFinish))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)c.completedFinish=new Date(c.completedFinish.valueOf()+c.completedFinish.getTimezoneOffset()*6E4)}if(typeof c.isMilestone==="string")c.isMilestone=c.isMilestone.toLowerCase()=="true";if(typeof c.minStart==="string"){try{c.minStart=new Date(c.minStart)}catch(m){c.minStart=new Date(parseInt(c.minStart))}if(typeof e.isRelativeToTimezone===
"undefined"||e.isRelativeToTimezone)c.minStart=new Date(c.minStart.valueOf()+c.minStart.getTimezoneOffset()*6E4)}if(typeof c.maxStart==="string"){try{c.maxStart=new Date(c.maxStart)}catch(s){c.maxStart=new Date(parseInt(c.maxStart))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)c.maxStart=new Date(c.maxStart.valueOf()+c.maxStart.getTimezoneOffset()*6E4)}if(typeof c.minFinish==="string"){try{c.minFinish=new Date(c.minFinish)}catch(g){c.minFinish=new Date(parseInt(c.minFinish))}if(typeof e.isRelativeToTimezone===
"undefined"||e.isRelativeToTimezone)c.minFinish=new Date(c.minFinish.valueOf()+c.minFinish.getTimezoneOffset()*6E4)}if(typeof c.maxFinish==="string"){try{c.maxFinish=new Date(c.maxFinish)}catch(o){c.maxFinish=new Date(parseInt(c.maxFinish))}if(typeof e.isRelativeToTimezone==="undefined"||e.isRelativeToTimezone)c.maxFinish=new Date(c.maxFinish.valueOf()+c.maxFinish.getTimezoneOffset()*6E4)}if(typeof c.predecessors!=="undefined"){if(typeof c.predecessors==="string")c.predecessors=c.predecessors.split(",");
for(var H=0;H<c.predecessors.length;H++){var n=c.predecessors[H];if(typeof n==="string"){n={item:n};c.predecessors[H]=n}if(typeof n.item==="string"){var l=parseInt(n.item)-1;n.item=l>=0&&l<a.length?a[l]:null}if(typeof n.lag==="string")n.lag=parseFloat(n.lag)}}}},O=function(a){for(var e=null,d=0;d<a.length;d++){var c=a[d];if(typeof c.indentation==="undefined")c.indentation=0;if(d==0&&c.indentation!=0){c.indentation=0;l(c,"indentation",false,true)}if(e!=null){var f=e.indentation+1;if(c.indentation>
f){c.indentation=f;l(c,"indentation",false,true)}e.hasChildren=c.indentation>e.indentation;if(e.hasChildren&&typeof e.isMilestone!=="undefined"&&e.isMilestone){e.isMilestone=false;l(e,"isMilestone",false,true)}}e=c}if(e!=null)e.hasChildren=false},R=function(a,e,d){d.isTimingInformationInitialized=false;d.isBasicTimingInformationInitialized=false;var c=k(new Date),f=[],b,j,m;for(j=0;j<a.length;j++){b=a[j];b.index=j;var s=null;for(f.length>0&&(s=f[f.length-1]);s!=null&&b.indentation<=s.indentation;){f.pop();
s=f[f.length-1]}b.parent=s;b.children=[];s!=null&&s.children.push(b);if(!b.hasChildren||!(typeof b.isSummaryEnabled==="undefined"||b.isSummaryEnabled)){m=b.start;var g=b.finish,o=b.completedFinish;if(typeof b.start==="undefined")b.start=c;if(typeof b.finish==="undefined")b.finish=typeof b.isMilestone==="undefined"||!b.isMilestone?q(c):b.start;if(typeof b.completedFinish==="undefined")b.completedFinish=b.start;if(typeof b.isRelativeToTimezone==="undefined"||b.isRelativeToTimezone){b.start=new Date(b.start.valueOf()-
b.start.getTimezoneOffset()*6E4);b.finish=new Date(b.finish.valueOf()-b.finish.getTimezoneOffset()*6E4);b.completedFinish=typeof b.completedFinish==="number"?y(b.start,b.completedFinish*u(b.start,b.finish,e,b.schedule),e,b.schedule):new Date(b.completedFinish.valueOf()-b.completedFinish.getTimezoneOffset()*6E4);if(typeof b.minStart!=="undefined")b.minStart=new Date(b.minStart.valueOf()-b.minStart.getTimezoneOffset()*6E4);if(typeof b.maxStart!=="undefined")b.maxStart=new Date(b.maxStart.valueOf()-
b.maxStart.getTimezoneOffset()*6E4);if(typeof b.minFinish!=="undefined")b.minFinish=new Date(b.minFinish.valueOf()-b.minFinish.getTimezoneOffset()*6E4);if(typeof b.maxFinish!=="undefined")b.maxFinish=new Date(b.maxFinish.valueOf()-b.maxFinish.getTimezoneOffset()*6E4);b.isRelativeToTimezone=false}else if(typeof b.completedFinish==="number")b.completedFinish=y(b.start,b.completedFinish*u(b.start,b.finish,e,b.schedule),e,b.schedule);if(typeof b.minStart!=="undefined"&&b.start<b.minStart)b.start=b.minStart;
else if(typeof b.maxStart!=="undefined"&&b.start>b.maxStart)b.start=b.maxStart;if(typeof b.maxFinish!=="undefined"&&b.finish>b.maxFinish)b.finish=b.maxFinish;else if(typeof b.minFinish!=="undefined"&&b.finish<b.minFinish)b.finish=b.minFinish;if(b.finish<b.start)b.finish=b.start;if(b.completedFinish<b.start)b.completedFinish=b.start;else if(b.completedFinish>b.finish)b.completedFinish=b.finish;b.start=v(b.start,e,true,typeof b.isMilestone!=="undefined"&&b.isMilestone,b.schedule);b.finish=v(b.finish,
e,typeof b.isMilestone!=="undefined"&&b.isMilestone,true,b.schedule);b.completedFinish=v(b.completedFinish,e,typeof b.isMilestone!=="undefined"&&b.isMilestone,true,b.schedule);if(b.finish<b.start)b.finish=b.start;if(typeof b.isMilestone==="undefined")b.isMilestone=!(b.hasChildren&&(typeof b.isSummaryEnabled==="undefined"||b.isSummaryEnabled))&&b.finish.valueOf()==b.start.valueOf();if(b.completedFinish<b.start)b.completedFinish=b.start;if(b.completedFinish>b.finish)b.completedFinish=b.finish;typeof b.dependsOf!==
"undefined"&&delete b.dependsOf;(typeof m==="undefined"||b.start.valueOf()!=m.valueOf())&&l(b,"start",false,true);(typeof g==="undefined"||b.finish.valueOf()!=g.valueOf())&&l(b,"finish",false,true);(typeof o==="undefined"||b.completedFinish.valueOf()!=o.valueOf())&&l(b,"completedFinish",false,true)}for(m=0;m<f.length;m++){g=f[m];if(typeof g.start==="undefined"||g.start>b.start){g.start=b.start;l(g,"start",false,true)}if(typeof g.finish==="undefined"||g.finish<b.finish){g.finish=b.finish;l(g,"finish",
false,true)}if(typeof g.completedFinish==="undefined"||g.completedFinish.valueOf()!=g.start.valueOf()){g.completedFinish=g.start;l(g,"completedFinish",false,true)}}(s==null||b.indentation>s.indentation)&&f.push(b)}d.isBasicTimingInformationInitialized=true;for(j=a.length;j-- >0;){b=a[j];b.hasChildren&&(typeof b.isSummaryEnabled==="undefined"||b.isSummaryEnabled)&&z(b)}if(e.areTaskDependencyConstraintsEnabled)for(j=0;j<a.length;j++){b=a[j];typeof b.predecessors!=="undefined"&&(b.predecessors!=null&&
b.predecessors.length>0)&&G(b,a,e,d)}d.isTimingInformationInitialized=true},z=function(a,e){if(!(a.children.length<=0||typeof a.isSummaryEnabled!=="undefined"&&!a.isSummaryEnabled)){typeof e==="undefined"&&(e=true);var d=a.start,c=a.finish,f=a.completedFinish;delete a.start;delete a.finish;delete a.completedFinish;for(var b=0;b<=1;b++){for(var j=0;j<a.children.length;j++){var m=a.children[j];if(!(typeof m.isParentSummarizationEnabled!=="undefined"&&!m.isParentSummarizationEnabled&&b<1)){if(typeof a.start===
"undefined"||a.start>m.start)a.start=m.start;if(typeof a.finish==="undefined"||a.finish<m.finish)a.finish=m.finish}}if(typeof a.start!=="undefined"&&typeof a.finish!=="undefined")break}a.completedFinish=a.start;(typeof d==="undefined"||a.start.valueOf()!=d.valueOf())&&l(a,"start",false,e);(typeof c==="undefined"||a.finish.valueOf()!=c.valueOf())&&l(a,"finish",false,e);(typeof f==="undefined"||a.completedFinish.valueOf()!=f.valueOf())&&l(a,"completedFinish",false,e)}},p=function(a,e){var d=a.parent;
return d==null?false:(typeof d.isSummaryEnabled==="undefined"||d.isSummaryEnabled)&&d==e?true:p(d,e)},A=function(a,e){if(typeof a.predecessors==="undefined")return false;for(var d=0;d<a.predecessors.length;d++)if(a.predecessors[d].item==e)return true;return false},k=function(a){return new Date(Math.floor(a.valueOf()/864E5)*864E5)},h=function(a){return a.valueOf()-k(a).valueOf()},r=function(a){a=Math.floor((a.valueOf()-2592E5)/864E5)%7;a<0&&(a=a+7);return a},q=function(a){return new Date(a.valueOf()+
864E5)},x=function(a){return new Date(a.valueOf()-864E5)},ba=function(a,e){if(typeof e==="undefined")return false;for(var d=a.valueOf(),c=0;c<e.length;c++)if(e[c].valueOf()==d)return true;return false},P=function(a){for(a=a.parent;a!=null;){z(a);a=a.parent}},l=function(a,e){if(typeof a.taskManager!=="undefined"){var d=a.taskManager,c=d.settings;if(e=="start"||e=="minStart"||e=="maxStart"){if(typeof a.minStart!=="undefined"&&a.start<a.minStart){a.start=a.minStart;a.start=v(a.start,c,true,typeof a.isMilestone!==
"undefined"&&a.isMilestone,a.schedule)}else if(typeof a.maxStart!=="undefined"&&a.start>a.maxStart){a.start=a.maxStart;a.start=v(a.start,c,true,typeof a.isMilestone!=="undefined"&&a.isMilestone,a.schedule)}if(a.finish<a.start){a.finish=a.start;l(a,"finish",false,true)}if(a.completedFinish<a.start){a.completedFinish=a.start;l(a,"completedFinish",false,true)}else if(a.completedFinish>a.finish){a.completedFinish=a.finish;l(a,"completedFinish",false,true)}}else if(e=="finish"||e=="minFinish"||e=="maxFinish"){if(typeof a.maxFinish!==
"undefined"&&a.finish>a.maxFinish){a.finish=a.maxFinish;a.finish=v(a.finish,c,typeof a.isMilestone!=="undefined"&&a.isMilestone,true,a.schedule)}else if(typeof a.minFinish!=="undefined"&&a.finish<a.minFinish){a.finish=a.minFinish;a.finish=v(a.finish,c,typeof a.isMilestone!=="undefined"&&a.isMilestone,true,a.schedule)}if(a.finish<a.start){a.finish=a.start;l(a,"finish",false,true)}if(a.completedFinish<a.start){a.completedFinish=a.start;l(a,"completedFinish",false,true)}else if(a.completedFinish>a.finish){a.completedFinish=
a.finish;l(a,"completedFinish",false,true)}}if(d.isTimingInformationInitialized){var f=d.items,b,j;if(e=="indentation"||e=="predecessors")for(b=0;b<f.length;b++){j=f[b];typeof j.dependsOf!=="undefined"&&delete j.dependsOf}if((e=="predecessors"||e=="start"||e=="finish")&&typeof a.isDuringPropertyChangeTaskDependencyConstraintsEnsuring==="undefined"&&c.areTaskDependencyConstraintsEnabled){a.isDuringPropertyChangeTaskDependencyConstraintsEnsuring=true;for(j=a.parent;j!=null;){typeof j.predecessors!==
"undefined"&&j.predecessors.length>0&&G(j,f,c,d);j=j.parent}j=a;for(typeof j.predecessors!=="undefined"&&j.predecessors.length>0&&G(j,f,c,d);j!=null;){if(typeof j.successors==="undefined"){j.successors=[];for(b=0;b<f.length;b++){var m=f[b];if(!(m==j||typeof m.predecessors==="undefined"||m.predecessors.length==0))for(var s=0;s<m.predecessors.length;s++)if(m.predecessors[s].item==j){j.successors.push(m);break}}}for(b=0;b<j.successors.length;b++)G(j.successors[b],f,c,d);j=j.parent}delete a.isDuringPropertyChangeTaskDependencyConstraintsEnsuring}}}},
G=function(a,e,d,c){if(c.isBasicTimingInformationInitialized){for(var f=[],b,j=false,c=0;c<a.predecessors.length;c++){b=a.predecessors[c];typeof b.item==="undefined"||e.indexOf(b.item)<0||Q(b.item,a)?j=true:f.push(b)}a.predecessors=f;j&&l(a,"predecessors",false,true);for(c=0;c<a.predecessors.length;c++){b=a.predecessors[c];ca(a,b,e,d)}}},ca=function(a,e,d,c){if(a.hasChildren&&(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))for(var f=0;f<a.children.length;f++)ca(a.children[f],e,d,c);
else{var b=e.item,j,d=false;if(typeof e.dependencyType==="undefined"||e.dependencyType==""||e.dependencyType=="FinishStart"||e.dependencyType=="FS"){b=b.finish;typeof e.lag!=="undefined"&&e.lag!=0&&(b=y(b,e.lag,c,a.schedule));if(a.start<b){if(!a.isMilestone&&(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))){f=u(a.start,a.finish,c,a.schedule);j=u(a.start,a.completedFinish,c,a.schedule)}if(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)){a.start=
v(b,c,true,a.isMilestone,a.schedule);l(a,"start",false,true);if(a.isMilestone){a.finish=a.start;l(a,"finish",false,true);a.completedFinish=a.start}else{a.finish=y(a.start,f,c,a.schedule);l(a,"finish",false,true);a.completedFinish=y(a.start,j,c,a.schedule)}l(a,"completedFinish",false,true);d=true}}}else if(e.dependencyType=="StartStart"||e.dependencyType=="SS"){b=b.start;typeof e.lag!=="undefined"&&e.lag!=0&&(b=y(b,e.lag,c,a.schedule));if(a.start<b){if(!a.isMilestone&&(!a.hasChildren||!(typeof a.isSummaryEnabled===
"undefined"||a.isSummaryEnabled))){f=u(a.start,a.finish,c,a.schedule);j=u(a.start,a.completedFinish,c,a.schedule)}if(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)){a.start=v(b,c,true,a.isMilestone,a.schedule);l(a,"start",false,true);if(a.isMilestone){a.finish=a.start;l(a,"finish",false,true);a.completedFinish=a.start}else{a.finish=y(a.start,f,c,a.schedule);l(a,"finish",false,true);a.completedFinish=y(a.start,j,c,a.schedule)}l(a,"completedFinish",false,true);d=true}}}else if(e.dependencyType==
"FinishFinish"||e.dependencyType=="FF"){b=b.finish;typeof e.lag!=="undefined"&&e.lag!=0&&(b=y(b,e.lag,c,a.schedule));if(a.finish>b&&(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))){a.finish=v(b,c,a.isMilestone,true,a.schedule);if(a.finish<a.start)a.finish=a.start;l(a,"finish",false,true);if(a.isMilestone){if(a.completedFinish!=a.start){a.completedFinish=a.start;l(a,"completedFinish",false,true)}}else if(a.completedFinish>a.finish){a.completedFinish=a.finish;l(a,"completedFinish",
false,true)}d=true}}else if(e.dependencyType=="StartFinish"||e.dependencyType=="SF"){b=b.start;typeof e.lag!=="undefined"&&e.lag!=0&&(b=y(b,e.lag,c,a.schedule));if(a.finish>b&&(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))){a.finish=v(b,c,a.isMilestone,true,a.schedule);if(a.finish<a.start)a.finish=a.start;l(a,"finish",false,true);if(a.isMilestone){if(a.completedFinish!=a.start){a.completedFinish=a.start;l(a,"completedFinish",false,true)}}else if(a.completedFinish>
a.finish){a.completedFinish=a.finish;l(a,"completedFinish",false,true)}d=true}}if(d)for(a=a.parent;a!=null;){z(a);a=a.parent}}},Q=function(a,e){if(typeof a.dependsOf!=="undefined"&&typeof a.dependsOf[a]!=="undefined")return a.dependsOf[e];try{if(a==e)return true;var d=D(a);if(d.indexOf(e)>=0)return true;var c=D(e);if(c.indexOf(a)>=0)return true;var f=t(a),b,j;for(b=0;b<f.length;b++){j=f[b];if(j==e||j==a||d.indexOf(j)>=0||c.indexOf(j)>=0||Q(j,e))return true}for(f=0;f<d.length;f++){var m=t(d[f]);for(b=
0;b<m.length;b++){j=m[b];if(j==e||j==a||d.indexOf(j)>=0||c.indexOf(j)>=0||Q(j,e))return true}}var s=a.children;for(b=0;b<s.length;b++){var g=s[b];if(typeof g.predecessors!=="undefined"&&g.predecessors.length>0&&Q(g,e))return true}}finally{if(typeof a.dependsOf==="undefined")a.dependsOf={};a.dependsOf[e]=true}return a.dependsOf[e]=false},D=function(a){for(var e=[];typeof a.parent!=="undefined"&&a.parent!=null;){(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)&&e.push(a.parent);a=a.parent}return e},
t=function(a){var e=[];if(typeof a.predecessors!=="undefined"&&a.predecessors!=null)for(var d=0;d<a.predecessors.length;d++)typeof a.predecessors[d].item!=="undefined"&&e.push(a.predecessors[d].item);return e},B=function(a,e,d){return v(a,e,true,true,d)},v=function(a,e,d,c,f){var b=f&&f.workingDayStart?f.workingDayStart:e.workingDayStart,j=f&&f.workingDayFinish?f.workingDayFinish:e.workingDayFinish,m=f&&f.workingWeekStart?f.workingWeekStart:e.workingWeekStart,s=f&&f.workingWeekFinish?f.workingWeekFinish:
e.workingWeekFinish,e=f&&f.nonworkingDays?f.nonworkingDays:e.nonworkingDays,f=k(a),a=h(a);if(a<b||!d&&a==b)if(d)a=b;else{f=x(f);a=j}if(a>j||!c&&a==j)if(c)a=j;else{f=q(f);a=b}for(c=r(f);c<m||c>s||ba(f,e);){if(d){c++;f=q(f);a=b}else{c--;f=x(f);a=j}for(;c<0;)c=c+7;for(;c>=7;)c=c-7}return new Date(f.valueOf()+a)},u=function(a,e,d,c){if(e.valueOf()<a.valueOf())return-u(e,a,d,c);if(e.valueOf()==a.valueOf())return 0;var f=c&&c.workingDayStart?c.workingDayStart:d.workingDayStart,b=c&&c.workingDayFinish?c.workingDayFinish:
d.workingDayFinish,j=c&&c.workingWeekStart?c.workingWeekStart:d.workingWeekStart,m=c&&c.workingWeekFinish?c.workingWeekFinish:d.workingWeekFinish,c=c&&c.nonworkingDays?c.nonworkingDays:d.nonworkingDays,d=0,s=k(a),a=h(a);if(a<f)a=f;else if(a>=b){s=q(s);a=f}for(var g=k(e);s<g;){var o=r(s);o>=j&&(o<=m&&!ba(s,c))&&(d=d+(b-a));s=q(s);a=f}e=h(e);e<f?e=f:e>b&&(e=b);e>a&&(d=d+(e-a));return d},y=function(a,e,d,c){if(e<0)return U(-e,a,d,c);a=v(a,d,true,false,c);if(e==0)return a;var f=c&&c.workingDayStart?c.workingDayStart:
d.workingDayStart,b=c&&c.workingDayFinish?c.workingDayFinish:d.workingDayFinish,j=h(a);if(j+e<b)return new Date(a.valueOf()+e);j=b-j;a=new Date(a.valueOf()+j);for(e=e-j;e>0;){a=h(a)>0?v(q(k(a)),d,true,false,c):v(k(a),d,true,false,c);if(f+e<b)return new Date(a.valueOf()+e);j=b-f;a=new Date(a.valueOf()+j);e=e-j}return new Date(a.valueOf())},U=function(a,e,d,c){if(a<0)return y(e,-a,d,c);e=v(e,d,false,true,c);if(a==0)return e;var f=c&&c.workingDayStart?c.workingDayStart:d.workingDayStart,b=c&&c.workingDayFinish?
c.workingDayFinish:d.workingDayFinish,j=h(e);if(j-a>f)return new Date(e.valueOf()-a);j=j-f;e=new Date(e.valueOf()-j);for(a=a-j;a>0;){e=h(e)<864E5?v(k(e),d,false,true,c):v(x(k(e)),d,false,true,c);if(b-a>f)return new Date(e.valueOf()-a);j=b-f;e=new Date(e.valueOf()-j);a=a-j}return new Date(e.valueOf())},da=function(a,e,d,c,f){return u(a,e,c,f)/u(a,d,c,f)},ea=function(a,e,d,c,f){return y(a,e*u(a,d,c,f),c,f)},M=function(a){for(var e=0,a=K(a),d=0;d<a.length;d++)e=e+a[d].value;e==0&&(e=1);return e},V=function(a){if(a.hasChildren&&
(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)){for(var e=0,a=a.children,d=0;d<a.length;d++)e=e+V(a[d]);return e}return a.taskManager.getItemEffort(a)*M(a)},W=function(a){if(a.hasChildren&&(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)){for(var e=0,a=a.children,d=0;d<a.length;d++)e=e+W(a[d]);return e}return a.taskManager.getItemCompletedEffort(a)*M(a)},fa=function(a){var e=E;if(typeof a==="undefined")return e;for(var d=0;d<a.length;d++){var c=a[d];if((!c.hasChildren||
!(typeof c.isSummaryEnabled==="undefined"||c.isSummaryEnabled))&&c.finish>e)e=c.finish}return new Date(e.valueOf())},ga=function(a,e){for(var d=0,c=0;c<a.length;c++){var f=a[c];f.parent==null&&(d=d+I(f,e))}return d},ha=function(a,e){for(var d=0,c=0;c<a.length;c++){var f=a[c];f.parent==null&&(d=d+N(f,e))}return d},ia=function(a,e){for(var d=[],c=0;c<e.length;c++){var f=e[c];if(!(f==a||typeof f.predecessors==="undefined"||f.predecessors.length==0))for(var b=0;b<f.predecessors.length;b++)if(f.predecessors[b].item==
a){d.push(f);break}}return d},X=function(a,e){for(var d=[],c=ia(a,e),f=0;f<c.length;f++){var b=c[f];if(!(typeof b.predecessors==="undefined"||b.predecessors.length==0))for(var j=0;j<b.predecessors.length;j++)b.predecessors[j].item==a&&d.push({successor:b,predecessor:b.predecessors[j]})}return d},S=function(a,e,d,c){typeof e==="undefined"&&(e=0);var f=fa(d);if(a.finish>=f)return true;if(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))for(var b=X(a,d),f=0;f<b.length;f++){var j=
b[f].successor,m=b[f].predecessor;if(((typeof m.dependencyType==="undefined"||m.dependencyType==""||m.dependencyType=="FinishStart"||m.dependencyType=="FS")&&u(a.finish,j.start,c,a.schedule)<=e||(m.dependencyType=="StartStart"||m.dependencyType=="SS")&&u(a.start,j.start,c,a.schedule)<=e)&&S(j,e,d,c))return true}else{a=a.children;for(f=0;f<a.length;f++)if(S(a[f],e,d,c))return true}return false},Y=function(a,e,d){for(var c=0;c<a.length;c++){var f=a[c];(!f.hasChildren||!(typeof f.isSummaryEnabled===
"undefined"||f.isSummaryEnabled))&&(typeof f.predecessors!=="undefined"&&f.predecessors!=null&&f.predecessors.length>0)&&G(f,a,e,d)}},ja=function(a,e){for(var d=0,c=K(a),f=0;f<c.length;f++){var b=c[f],j=b.key,m;typeof e.specificResourceUsageCosts!=="undefined"&&(m=F(e.specificResourceUsageCosts,j))>=0?d=d+e.specificResourceUsageCosts[m].value*b.value:typeof e.defaultResourceUsageCost!=="undefined"&&(d=d+e.defaultResourceUsageCost*b.value);if(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||
a.isSummaryEnabled)){var s=I(a,e)/36E5;typeof e.specificResourceHourCosts!=="undefined"&&(m=F(e.specificResourceHourCosts,j))>=0?d=d+e.specificResourceHourCosts[m].value*s*b.value:typeof e.defaultResourceHourCost!=="undefined"&&(d=d+e.defaultResourceHourCost*s*b.value)}}return d},$=function(a,e){var d=typeof e.taskInitiationCost!=="undefined"?e.taskInitiationCost:0,d=d+ja(a,e);if(a.hasChildren&&(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))for(var c=0;c<a.children.length;c++)d=d+Z(a.children[c],
e);return d},Z=function(a,e){return(typeof a.executionCost!=="undefined"?a.executionCost:0)+$(a,e)},na=function(a,e,d,c,f,b,j){if(typeof d!=="undefined"){typeof a==="undefined"&&(a=false);typeof e==="undefined"&&(e=new Date);typeof b==="undefined"&&(b=false);typeof j==="undefined"&&(j=false);Y(d,c,f);for(var m=[],s=[],g,o,H=[],f=0;f<d.length;f++){g=d[f];if(!g.hasChildren||!(typeof g.isSummaryEnabled==="undefined"||g.isSummaryEnabled)){if(j){o=false;for(var n=g;n!=null;){if(typeof n.predecessors!==
"undefined"&&n.predecessors.length>0){o=true;break}n=n.parent}if(!o)continue}m.push({key:g,value:va(g)});var n=!b?K(g):[],h=[];for(o=0;o<n.length;o++){var k=n[o];k.value>0&&h.push(k)}s.push({key:g,value:h});H.push(g)}}d=[];for(b=m.length;b>0;){j=[];for(f=0;f<m.length;f++){g=m[f].key;o=true;n=m[f].value;for(h=0;h<n.length;h++){k=n[h];if(F(m,k)>=0&&j.indexOf(k)<0){o=false;break}}if(o){h=g;o=e;n=c;if(typeof h.minStart!=="undefined"&&o<h.minStart)o=h.minStart;if(a||!(h.completedFinish>h.start))for(;h!=
null;){if(typeof h.predecessors!=="undefined")for(k=0;k<h.predecessors.length;k++){var p=h.predecessors[k];if(typeof p!=="undefined"){var q=p.dependencyType;typeof q==="undefined"&&(q="FinishStart");switch(q){case "":case "FinishStart":case "FS":p=y(p.item.finish,typeof p.lag==="undefined"?0:p.lag,n,p.item.schedule);p>o&&(o=p);break;case "StartStart":case "SS":p=y(p.item.start,typeof p.lag==="undefined"?0:p.lag,n,p.item.schedule);p>o&&(o=p)}}}for(h=h.parent;h!=null&&typeof h.isSummaryEnabled!=="undefined"&&
!h.isSummaryEnabled;)h=h.parent}n=o;o=F(s,g);var h=s[o].value,t;for(o=0;o<h.length;o++){t=h[o].key;k=h[o].value;q=F(d,t);if(q>=0){p=1;if(typeof c.resourceQuantities!=="undefined"){var r=F(c.resourceQuantities,t);if(r>=0)p=c.resourceQuantities[r].value}previousAllocations=d[q].value;for(q=0;q<previousAllocations.length;q++){t=previousAllocations[q].key;if(!(t+k<=p)){r=previousAllocations[q].value;r>n&&(n=r)}}}}if((a||!(g.completedFinish>g.start))&&(n=v(n,c,true,false,g.schedule))!=g.start){o=I(g,c);
k=N(g,c);ka(g,n);la(g,y(g.start,o,c,g.schedule));ma(g,k,c)}p=g.finish;for(o=0;o<h.length;o++){t=h[o].key;k=h[o].value;q=F(d,t);if(q<0){r=[];d.push({key:t,value:r})}else r=d[q].value;for(var u=[{key:k,value:p}],w,q=0;q<r.length;q++){t=r[q].key;var B=r[q].value;if(B>n){var A=t+k,x=B<p?B:p;w=F(u,A);if(w<0)u.push({key:A,value:x});else if(x>u[A])u[w].value=x;B<p?u.push({key:t+k,value:B}):u.push({key:t+k,value:p})}}for(k=0;k<u.length;k++){A=u[k].key;x=u[k].value;w=F(r,A);if(w<0)r.push({key:A,value:x});
else if(x>r[w].value)r[w].value=x}}j.push(g)}}for(f=0;f<j.length;f++)m.splice(m.indexOf(j[f]),1);if(m.length==b)break;b=m.length}for(f=0;f<H.length;f++){g=H[f];l(g,"start",true,true);l(g,"finish",true,true);l(g,"completedFinish",true,true);for(a=g.parent;a!=null;){z(a);g=a;a=g.parent}}}},va=function(a){for(var e=[],a=t(a),d=0;d<a.length;d++)oa(a[d],e);return e},oa=function(a,e){if(!a.hasChildren||!(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled))e.indexOf(a)<0&&e.push(a);else for(var d=
0;d<a.children.length;d++)oa(a.children[d],e)},I=function(a,e){if(a.hasChildren&&(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)){for(var d=0,c=a.children,f=0;f<c.length;f++)d=d+I(c[f],e);return d}return u(a.start,a.finish,e,a.schedule)},N=function(a,e){if(a.hasChildren&&(typeof a.isSummaryEnabled==="undefined"||a.isSummaryEnabled)){for(var d=0,c=a.children,f=0;f<c.length;f++)d=d+N(c[f],e);return d}return u(a.start,a.completedFinish,e,a.schedule)},ma=function(a,e,d){a.completedFinish=
y(a.start,e,d,a.schedule);l(a,"completedFinish",false,false)},ka=function(a,e){a.start=e;l(a,"start",false,false);pa(a,false)},la=function(a,e){a.finish=e;l(a,"finish",false,false);pa(a,false)},pa=function(a,e){for(var d=a.parent;d!=null;){z(d,e);a=d;d=a.parent}},qa=function(a,e,d){typeof d==="undefined"&&(d=false);var c=a.parent,f=a.index;if(c==null){for(c=0;f-- >0;){a=e[f];a.indentation==0&&c++}return c+(!d?1:0)}return qa(c,e)+"."+(c.children.indexOf(a)+(!d?1:0))},K=function(a){var e=[];if(typeof a.assignments===
"undefined")return e;for(var d=0;d<a.assignments.length;d++){var c=a.assignments[d];typeof c.resource==="undefined"||c.resource==null||e.push({key:c.resource,value:typeof c.allocationUnits!=="undefined"&&!isNaN(c.allocationUnits)?c.allocationUnits:1})}return e},ra=function(a){for(var e=[],a=K(a),d=0;d<a.length;d++)e.push(a[d].key);return e},T=function(a,e){if(typeof e==="undefined")return[];for(var d=[],c=0;c<e.length;c++){var f=e[c];if(!f.hasChildren||!(typeof f.isSummaryEnabled==="undefined"||f.isSummaryEnabled))for(var b=
K(f),j=0;j<b.length;j++){var m=b[j];if(m.key==a){d.push({key:f,value:m.value});break}}}return d},aa=function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")},F=function(a,e){for(var d=0;d<a.length;d++)if(a[d].key==e)return d;return-1},sa=function(a){return typeof a!=="undefined"?new Date(a.valueOf()+a.getTimezoneOffset()*6E4):a},ta=function(a){return typeof a!=="undefined"?new Date(a.valueOf()-a.getTimezoneOffset()*6E4):a},ua=function(a,e,d){for(var c=0;c<e.length;c++)e[c].taskManager=a;a.items=
e;a.settings=d;a.refresh=function(){J(a)};a.refreshItemPath=P;a.refreshItemNeighbourhood=function(f){L(e,d);O(e);R(e,d,a);var b;b=f.index-1;b>=0&&P(e[b]);P(f);b=f.index+1;b<e.length&&P(e[b])};a.getWorkingTime=function(a){return B(a,d)};a.getStartWorkingTime=function(a){return v(a,d,true,false,void 0)};a.getFinishWorkingTime=function(a){return v(a,d,false,true,void 0)};a.getEffort=function(a,b){return u(a,b,d)};a.getFinish=function(a,b){return y(a,b,d)};a.getStart=function(a,b){return U(a,b,d)};a.getCompletion=
function(a,b,e){return da(a,b,e,d)};a.getCompletedFinish=function(a,b,e){return ea(a,b,e,d)};a.setItemStart=function(a,b){a.start=v(b,d,true,false,a.schedule);l(a,"start",true,true);if(a.completedFinish<a.start){a.completedFinish=a.start;l(a,"completedFinish",false,true)}};a.setItemFinish=function(a,b){a.finish=v(b,d,false,true,a.schedule);l(a,"finish",true,true);if(a.completedFinish>a.finish){a.completedFinish=a.finish;l(a,"completedFinish",false,true)}};a.setItemIsMilestone=function(a,b){a.isMilestone=
b;l(a,"isMilestone",true,true)};a.getItemEffort=function(a){return I(a,d)};a.setItemEffort=function(a,b){a.finish=y(a.start,b,d,a.schedule);l(a,"finish",true,true);if(a.completedFinish>a.finish){a.completedFinish=a.finish;l(a,"completedFinish",false,true)}};a.getItemTotalEffort=function(a){return V(a)};a.setItemTotalEffort=function(a,b){a.taskManager.setItemEffort(a,b/M(a))};a.getItemDuration=function(a){return u(a.start,a.finish,d,a.schedule)};a.setItemDuration=a.setItemEffort;a.getItemCompletedEffort=
function(a){return N(a,d)};a.setItemCompletedEffort=function(a,b){a.completedFinish=y(a.start,b,d,a.schedule);if(a.completedFinish>a.finish)a.completedFinish=a.finish;l(a,"completedFinish",true,true)};a.getItemTotalCompletedEffort=function(a){return W(a)};a.setItemTotalCompletedEffort=function(a,b){a.taskManager.setItemCompletedEffort(a,b/M(a))};a.getItemCompletion=function(f){return a.getItemCompletedEffort(f)/a.getItemEffort(f)};a.setItemCompletion=function(f,b){a.setItemCompletedEffort(f,b*a.getItemEffort(f))};
a.isItemCompleted=function(f){return a.getItemCompletion(f)>=1};a.setItemAsCompleted=function(f){a.setItemCompletion(f,1)};a.hasItemStarted=function(a){return a.completedFinish>a.start};a.setItemAsNotStarted=function(f){a.setItemCompletion(f,0)};a.isItemOnSchedule=function(a){var b=new Date,b=new Date(b.valueOf()-b.getTimezoneOffset()*6E4);return a.completedFinish>=b};a.getItemAssignmentsString=function(a){var b="";if(!(typeof a.assignments==="undefined"||a.assignments.length==0))for(var e=0;e<a.assignments.length;e++){var d=
a.assignments[e];if(!(typeof d.resource===void 0||d.resource==null)){b.length>0&&(b=b+", ");b=b+d.resource;typeof d.allocationUnits===void 0||(isNaN(d.allocationUnits)||d.allocationUnits==1)||(b=b+(" ["+Math.round(d.allocationUnits*1E4)/100+"%]"))}}return b};a.setItemAssignmentsString=function(a,b){var e=[];a.assignments=e;for(var d=b.split(","),c=0;c<d.length;c++){var g=aa(d[c]);if(!(g.length<=0)){var o,h=g.indexOf("[");if(h<0){o=g;g=""}else{o=aa(g.substr(0,h));g=g.substr(h+1);h=g.indexOf("%");h<
0&&(h=g.indexOf("]"));h>=0&&(g=g.substr(0,h))}g=g.length>0?parseFloat(g):100;isNaN(g)&&(g=100);g=g/100;e.push({resource:o,allocationUnits:g})}}l(a,"assignments",true,true)};a.getItemPredecessorsString=function(a,b){var d=b;typeof d==="undefined"&&(d=false);var c="";if(!(typeof a.predecessors==="undefined"||a.predecessors.length==0))for(var s=0;s<a.predecessors.length;s++){var g=a.predecessors[s],h=e.indexOf(g.item);if(!(h<0)){c.length>0&&(c=c+", ");c=c+(h+(!d?1:0));if(typeof g.dependencyType!=="undefined"&&
g.dependencyType!=""&&g.dependencyType!="FinishStart"&&g.dependencyType!="FS")if(g.dependencyType=="StartStart"||g.dependencyType=="SS")c=c+"SS";else if(g.dependencyType=="FinishFinish"||g.dependencyType=="FF")c=c+"FF";else if(g.dependencyType=="StartFinish"||g.dependencyType=="SF")c=c+"SF";if(typeof g.lag!=="undefined"&&g.lag!=0){g.lag>0&&(c=c+"+");c=c+g.lag/36E5}}}return c};a.setItemPredecessorsString=function(a,b,d){typeof d==="undefined"&&(d=false);var c=[];a.predecessors=c;for(var b=b.split(","),
h=0;h<b.length;h++){var g=aa(b[h]);if(!(g.length<=0)){for(var o=0;o<g.length&&g.charCodeAt(o)>=48&&g.charCodeAt(o)<=57;)o++;var k=g.substr(0,o),k=parseInt(k)-(!d?1:0);if(!isNaN(k)&&!(k<0||k>e.length)){k=e[k];if(!(a==k||p(a,k)||p(k,a))&&!A(a,k)&&!A(k,a)){var g=g.substr(o),o=g.indexOf("+"),n=g.indexOf("-"),q=o>=0?o:n>=0?n:-1,n=0;if(q>=0){var r=parseFloat(g.substr(q+1));isNaN(r)||(n=r*(o>=0?1:-1)*36E5)}g=(q<0?g:g.substr(0,q)).toUpperCase();c.push({item:k,dependencyType:g,lag:n})}}}}l(a,"predecessors",
true,true)};a.getItemIndexString=function(a,b){typeof b==="undefined"&&(b=false);return typeof a.index!=="undefined"?(a.index+(!b?1:0)).toString():""};a.getItemWbsIndexString=function(a,b){return qa(a,e,b).toString()};a.getRootItems=function(){for(var a=[],b=0;b<e.length;b++){var d=e[b];d.parent==null&&a.push(d)}return a};a.getLeaveItems=function(){for(var a=[],b=0;b<e.length;b++){var d=e[b];d.parent!=null&&a.push(d)}return a};a.getProjectStart=function(){var a;a=w;if(typeof e!=="undefined"){for(var b=
0;b<e.length;b++){var d=e[b];if((!d.hasChildren||!(typeof d.isSummaryEnabled==="undefined"||d.isSummaryEnabled))&&d.start<a)a=d.start}a=new Date(a.valueOf())}return a};a.getProjectFinish=function(){return fa(e)};a.getProjectEffort=function(){return ga(e,d)};a.getProjectTotalEffort=function(){for(var a=0,b=0;b<e.length;b++){var d=e[b];d.parent==null&&(a=a+V(d))}return a};a.getProjectCompletedEffort=function(){return ha(e,d)};a.getProjectTotalCompletedEffort=function(){for(var a=0,b=0;b<e.length;b++){var d=
e[b];d.parent==null&&(a=a+W(d))}return a};a.getProjectCompletion=function(){return ha(e,d)/ga(e,d)};a.isItemCritical=function(a,b){return S(a,b,e,d)};a.getCriticalItems=function(a){typeof a==="undefined"&&(a=0);if(typeof e==="undefined")a=void 0;else{for(var b=[],c=0;c<e.length;c++){var m=e[c];(!m.hasChildren||!(typeof m.isSummaryEnabled==="undefined"||m.isSummaryEnabled))&&S(m,a,e,d)&&b.push(m)}a=b}return a};a.ensureDependencyConstraints=function(){Y(e,d,a)};a.splitRemainingWork=function(c){if(typeof e===
"undefined"||c.hasChildren||c.isMilestone||!(c.completedFinish>c.start)||c.completedFinish>=c.finish)c=null;else{var b=e.indexOf(c);if(b<0)c=null;else{var j={tag:c.tag,indentation:c.indentation,start:c.completedFinish,finish:c.finish,assignments:c.assignments,isSummaryEnabled:c.isSummaryEnabled,isParentSummarizationEnabled:c.isParentSummarizationEnabled};c.finish=c.completedFinish;insertItem(b+1,j,a,e,d);for(var b=X(c,e),m=0;m<b.length;m++){var h=b[m].predecessor;if(typeof h.dependencyType==="undefined"||
h.dependencyType==""||h.dependencyType=="FinishStart"||h.dependencyType=="FS"||h.dependencyType=="FinishFinish"||h.dependencyType=="FF")h.item=j}j.predecessors=[{item:c}];c=j}}return c};a.optimizeWork=function(c,b,j,m){var h;typeof c==="undefined"&&(c=false);typeof b==="undefined"&&(b=false);typeof j==="undefined"&&(j=new Date);if(m)na(b,j,e,d,a,true,c);else{j=new Date(j.valueOf()+j.getTimezoneOffset()*6E4);h=[];for(m=0;m<e.length;m++){var g=e[m];if(!g.hasChildren||!(typeof g.isSummaryEnabled==="undefined"||
g.isSummaryEnabled))if(!(g.start<=j||!b&&g.completedFinish>g.start)){if(c){for(var o=false,k=g;k!=null;){if(typeof k.predecessors!=="undefined"&&k.predecessors.length>0){o=true;break}k=k.parent}if(!o)continue}var o=g,k=j,n=d,k=new Date(k.valueOf()-k.getTimezoneOffset()*6E4),k=v(k,n,true,false,o.schedule),p=I(o,n),q=N(o,n);ka(o,k);la(o,y(o.start,p,n,o.schedule));ma(o,q,n);h.push(g)}}Y(e,d,a);for(m=0;m<h.length;m++){c=h[m];l(c,"start",true,true);l(c,"finish",true,true);l(c,"completedFinish",true,true)}h=
void 0}return h};a.levelAllocations=function(e){if(!e)e=a.items;e.length||(e=[e]);for(var b=0;b<e.length;b++){var d=e[b],c,h=d.assignments;if(h&&h.length>0){var g=0;for(c=0;c<h.length;c++)g=g+(isNaN(h[c].allocationUnits)?1:h[c].allocationUnits);if(g>0){for(c=0;c<h.length;c++)d.assignments[c].allocationUnits=(isNaN(h[c].allocationUnits)?1:h[c].allocationUnits)/g;l(d,"assignments",false,true)}}}};a.levelResources=function(c,b){return na(c,b,e,d,a)};a.getItemSuccessors=function(a){return ia(a,e)};a.getItemSuccessorPredecessorItems=
function(a){return X(a,e)};a.getItemAllocationUnits=M;a.getItemAssignments=K;a.getItemAssignedResources=ra;a.getResourceAssignments=function(a){return T(a,e)};a.getResourceAssignedItems=function(a){for(var b=[],a=T(a,e),c=0;c<a.length;c++)b.push(a[c].key);return b};a.getAssignedResources=function(){var a;if(typeof e==="undefined")a=[];else{a=[];for(var b=0;b<e.length;b++){var c=e[b];if(!c.hasChildren||!(typeof c.isSummaryEnabled==="undefined"||c.isSummaryEnabled))for(var c=ra(c),d=0;d<c.length;d++){var h=
c[d];a.indexOf(h)<0&&a.push(h)}}}return a};a.getItemAssignmentsCost=function(a){return ja(a,d)};a.getItemExtraCost=function(a){return $(a,d)};a.getItemCost=function(a){return Z(a,d)};a.setItemCost=function(a,b){a.executionCost=b-$(a,d);l(a,"executionCost",true,true)};a.getResourceCost=function(a){for(var b=0,a=T(a,e),c=0;c<a.length;c++){var h=a[c],k;typeof d.specificResourceUsageCosts!=="undefined"&&(k=F(d.specificResourceUsageCosts,resource))>=0?b=b+d.specificResourceUsageCosts[k].value*h.value:
typeof d.defaultResourceUsageCost!=="undefined"&&(b=b+d.defaultResourceUsageCost*h.value);var g=h.key;if(!g.hasChildren||!(typeof g.isSummaryEnabled==="undefined"||g.isSummaryEnabled)){g=I(g,d)/36E5;typeof d.specificResourceHourCosts!=="undefined"&&(k=F(d.specificResourceHourCosts,resource))>=0?b=b+d.specificResourceHourCosts[k].value*g*h.value:typeof d.defaultResourceHourCost!=="undefined"&&(b=b+d.defaultResourceHourCost*g*h.value)}}return b};a.getProjectCost=function(){for(var a=0,b=0;b<e.length;b++){var c=
e[b];c.parent==null&&(a=a+Z(c,d))}return a};a.getAllocations=function(a){for(var b=[],a=T(a,e),c=0;c<a.length;c++){var d=a[c],h=d.key;if(!h.hasChildren||!(typeof h.isSummaryEnabled==="undefined"||h.isSummaryEnabled))for(h=[{start:h.start,finish:h.finish}];h.length>0;){var g;g=h[0];h.splice(0,1);if(!(g.finish<=g.start))if(b.length==0)b.push({key:g,value:d.value});else{for(var k=false,l=0;l<b.length;l++){var n=b[l].key,p=b[l].value;if(!(g.start>=n.finish))if(g.finish<=n.start){for(k=0;k<=l;k++)if(b[k].key.start>=
g.start){b.splice(k,0,{key:g,value:d.value});break}k=true;break}else if(g.start<=n.start&&g.finish>=n.finish){b[l].value=p+d.value;g.start<n.start&&h.push({start:g.start,finish:n.start});g.finish>n.finish&&h.push({start:n.finish,finish:g.finish});k=true;break}else if(g.start>=n.start&&g.finish<=n.finish){b.splice(l,1);g.start>n.start&&b.splice(l++,0,{key:{start:n.start,finish:g.start},value:p});b.splice(l++,0,{key:g,value:p+d.value});g.finish<n.finish&&b.splice(l++,0,{key:{start:g.finish,finish:n.finish},
value:p});k=true;break}else if(g.start>=n.start&&g.finish>=n.finish){b.splice(l,1);g.start>n.start&&b.splice(l++,0,{key:{start:n.start,finish:g.start},value:p});b.splice(l++,0,{key:{start:g.start,finish:n.finish},value:p+d.value});g.finish>n.finish&&h.push({start:n.finish,finish:g.finish});k=true;break}else if(g.start<=n.start&&g.finish<=n.finish){b.splice(l,1);g.start<n.start&&h.push({start:g.start,finish:n.start});b.splice(l++,0,{key:{start:n.start,finish:g.finish},value:p+d.value});g.finish<n.finish&&
b.splice(l++,0,{key:{start:g.finish,finish:n.finish},value:p});k=true;break}}k||b.push({key:g,value:d.value})}}}return b};a.getOutputDate=sa;a.getInputDate=ta};return{initialize:C,initializeItems:L,refresh:J,getWorkingTime:B,getEffort:u,getFinish:y,getStart:U,getCompletion:da,getCompletedFinish:ea,getOutputDate:sa,getInputDate:ta}}());
